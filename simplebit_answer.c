#include<string.h>
#include<stdio.h>
#include<stdlib.h>
void swap(int *table, int *data);
void swap2(int *table, int *data);
void encode(int *data,int data_length);
void decode(int *data,int data_length);
void print_char(int *data, int data_length);
void main()
{
	int data[288]={0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000001,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001};
	int original_data[288] = {0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000000,0x00000001,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000000};
	int real_data[288] ={0x00000000,0x00000000,0x00000001,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000000,0x00000001,0x00000001,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000000,0x00000001,0x00000001,0x00000001,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000001,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000000,0x00000000,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000000,0x00000001,0x00000001,0x00000001,0x00000000,0x00000000,0x00000001};
	int temp_data[288] ={0,};
	int table[16][288]= {0,};
	memcpy(temp_data,original_data,sizeof(original_data));
	for(int j =0; j <16 ; j++)
	{
		for(int i =0; i <288; i++)
		{
			table[j][i]=rand()%288;
		}
	}
	for(int k=0; k<=15;k++)
	{
		swap2(table[15-k],real_data);
		decode(real_data,288);
	}


	//compare data
	/*
	for(int i=0; i<288;i++)
	{
		if(original_data[i] != data[i])
		{
			printf("bit number %d miss matched..\n",i);
			return;		
		}
	}
	printf("original_data and data is matched!!\n");
	*/
	print_char(real_data,288);
}
void print_char(int *data, int data_length)
{
	char buffer = 0;
	int bit_count = 0;
	printf("start print\n");
	for(int i=0; i<data_length;i++)
	{
		buffer ^= (data[i]<<bit_count);
		if( bit_count >= 7)
		{
			bit_count = 0;
			printf("%c",buffer);
			buffer = 0;
			continue;
		}
		bit_count ++;
	}
	printf("end print\n");

}

void decode(int *data,int data_length)
{
        //   d\v| 0 | 1 |
        //   0  | 0 | 1 |
        //   1  | 1 | 0 |
        //decode table

        int decode_table[2][2] = { { 0, 1 },
                                   { 1, 0 }};
        int v =1;
        for(int i=0;i< data_length; i++)
        {
                int d= data[i];
                int result =  decode_table[d][v];
                if( result )
                {
                        v = v^0x1;
                }
                data[i]=result;
        }

}
void swap2(int *table, int *data)
{
        for(int i=288-1; i>=0 ; i--)
        {
                int v4 = table[i];
                int temp = data[v4];
                data[v4] =  data[287-i];
                data[287-i] = temp;
        }

}
void swap(int *table, int *data)
{
	for(int i=288-1; i>=0 ; i--)
	{
		int v4 = table[287-i];
		int temp = data[v4];
		data[v4] =  data[i];
		data[i] = temp;
	}
}
void encode(int *data,int data_length)
{
	int v = 1;
	for(int i=0;i< data_length;i++)
	{
		if(data[i])
		{
			v = v^0x1;
		}
		data[i] = v;
	}
}

